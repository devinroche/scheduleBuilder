"use strict";angular.module("scheduleBuilderApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","angucomplete-alt","vesparny.fancyModal"]).config(["$routeProvider","$locationProvider","$sceDelegateProvider",function(e,n,t){e.when("/",{templateUrl:"views/main.html"}).when("/build",{templateUrl:"views/build.html",controller:"BuildCtrl",controllerAs:"build"}).otherwise({redirectTo:"/"}),t.resourceUrlWhitelist(["self","https://schedule-builder-backend.herokuapp.com/**"]),n.hashPrefix("")}]),angular.module("scheduleBuilderApp").controller("BuildCtrl",["$scope","$http","toastr","httpService","calendarService","eventService","$fancyModal",function(e,n,t,a,s,l,o){e.allClasses=[],e.userClasses=[],e.events=[];var r=[];e.viableSchedules=[],e.formatRequest=[],e.showBtns=!1,e.edit=!1,e.classpick=!1;var i=0;e.inputWait=!0,e.noSchedules=!1,e.clearAll=function(){e.classpick=!1,e.viableSchedules=[],e.events=[],r=[],e.noSchedules=!1,e.showBtns=!1,e.vSched=[],i=0,e.formatRequest=[],e.userClasses=[],$("#calendar").fullCalendar("removeEvents"),t("warning","Potential classes have been cleared")},a.getClasses().then(function(n){e.allClasses=n.data,e.inputWait=!1}),e.addUserClasses=function(n){e.classpick=!0,e.userClasses.push(n)},e.toggleEdit=function(){e.edit=!e.edit},e.removeClass=function(n){var t=e.userClasses.indexOf(n);t>-1&&e.userClasses.splice(t,1)};var c=function(){$("#calendar").fullCalendar("removeEvents"),e.events=[]};e.generateSchedule=function(n){e.formatRequest=[],e.noSchedules=!1,c();for(var s=0;s<n.length;s++)e.formatRequest.push(n[s].description);if(0===e.formatRequest.length)t("error","One or more classes required");else{t("success","We are cookin up your schedules!");var l={classes:e.formatRequest,block:[]};a.postClass(l).then(function(n){r=n.data,e.viableSize=r.length,e.showCount=i+1,e.vSched=r[i],e.showBtns=!0,u()})}};var u=function(){var n=[];if("undefined"==typeof e.vSched)m();else{for(var t=0;t<e.vSched.length;t++)n.push(e.vSched[t].week);v(n)}},d=["#ff4444","#ffbb33","#00C851","#33b5e5","#2BBBAD","#4285F4","#aa66cc","#29b6f6","#f06292"],h=["#CC0000","#FF8800","#007E33","#0099CC","#00695c","#0d47a1","#9933CC","#039be5","#ec407a"],v=function(n){for(var t=0;t<n.length;t++){var a=l.eventObj(l.startTime(n[t]),l.endTime(n[t]),e.vSched[t].seminar,l.getDow(n[t]));a.backgroundColor=d[t],a.borderColor=h[t],e.events.push(a)}s.reloadCal(e.events),e.showCalendar()};e.nextPage=function(){c(),i===e.viableSize-1?i=0:i++,f()},e.prevPage=function(){c(),0===i?i=e.viableSize-1:i-=1,f()};var f=function(){e.showCount=i+1,e.vSched=r[i],u()},m=function(){e.noSchedules=!0,e.showBtns=!1};e.showCalendar=function(){$(document).ready(function(){$("#calendar").fullCalendar({defaultView:"agendaWeek",defaultDate:"2017-09-25",allDaySlot:!1,weekends:!1,header:!1,minTime:"08:00:00",maxTime:"21:00:00",height:480,events:e.events,eventClick:function(e){p(e)}})})};var p=function(n){for(var t=0;t<e.vSched.length;t++)if(e.vSched[t].seminar===n.title){e.classInformation=e.vSched[t],e.dt=e.classInformation.times.split(",").join(", "),e.loc="";for(var t=0;t<e.classInformation.location.length;t++)e.loc+=e.classInformation.location[t]+" ";o.open({templateUrl:"../../views/classModal.html",scope:e}),$(".fancymodal-overlay fancymodal-overlay-opening").removeClass("fancymodal-overlay fancymodal-overlay-opening"),$(".fancymodal-content").removeClass("fancymodal-content").addClass("modal-content modal-dialog")}}}]),angular.module("scheduleBuilderApp").service("toastr",function(){var e=function(e,n){toastr.options={closeButton:!1,debug:!1,newestOnTop:!0,progressBar:!0,positionClass:"toast-top-right",preventDuplicates:!0,showDuration:"300",hideDuration:"1000",timeOut:"1500",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr[e](n)};return e}),angular.module("scheduleBuilderApp").service("eventService",function(){this.getDow=function(e){for(var n in e)null!==e[n]&&void 0!==e[n]||delete e[n];for(var t=[],a=Object.keys(e),s=0;s<a.length;s++)"M"===a[s]?t.push(1):"T"===a[s]?t.push(2):"W"===a[s]?t.push(3):"R"===a[s]?t.push(4):"F"===a[s]&&t.push(5);return t},this.startTime=function(e){var n=removeNull(e);return n[Object.keys(n)[0]][0]},this.endTime=function(e){var n=removeNull(e);return n[Object.keys(n)[0]][1]},this.eventObj=function(e,n,t,a){e=moment(e,["h:mmA"]).format("HH:mm"),n=moment(n,["h:mmA"]).format("HH:mm");var s={title:t,start:e,end:n,dow:a,backgroundColor:"",borderColor:""};return s}});var wildCardHandler=function(e){tmpd.includes("M")&&tmpd.includes("T")||tmpd.includes("M")&&tmpd.includes("R")},removeNull=function(e){for(var n in e)null!==e[n]&&void 0!==e[n]||delete e[n];return e};angular.module("scheduleBuilderApp").service("calendarService",["$fancyModal",function(e){this.reloadCal=function(e){$("#calendar").fullCalendar("addEventSource",e),$("#calendar").fullCalendar("rerenderEvents")}}]);const baseUrl="http://localhost:3000/api/";angular.module("scheduleBuilderApp").service("httpService",["$http",function(e){this.getClasses=function(){return e.get(baseUrl+"classes")},this.postClass=function(n){return e.post(baseUrl+"schedules",n)}}]);