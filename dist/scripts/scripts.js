"use strict";angular.module("scheduleBuilderApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","angucomplete-alt","vesparny.fancyModal"]).config(["$routeProvider","$locationProvider","$sceDelegateProvider",function(e,n,t){e.when("/",{templateUrl:"views/main.html"}).when("/build",{templateUrl:"views/build.html",controller:"BuildCtrl",controllerAs:"build"}).otherwise({redirectTo:"/"}),t.resourceUrlWhitelist(["self","https://schedule-builder-backend.herokuapp.com/**"]),n.hashPrefix("")}]),angular.module("scheduleBuilderApp").controller("BuildCtrl",["$scope","$http","toastr","httpService","calendarService","eventService","$fancyModal",function(e,n,t,s,a,l,o){e.allClasses=[],e.userClasses=[],e.events=[];var r=[];e.viableSchedules=[],e.formatRequest=[],e.showBtns=!1,e.edit=!1,e.classpick=!1;var i=0;e.inputWait=!0,e.noSchedules=!1,e.clearAll=function(){e.classpick=!1,e.viableSchedules=[],e.events=[],r=[],e.noSchedules=!1,e.showBtns=!1,e.vSched=[],i=0,e.formatRequest=[],e.userClasses=[],$("#calendar").fullCalendar("removeEvents"),t("warning","Potential classes have been cleared")},s.getClasses().then(function(n){e.inputWait=!1,e.allClasses=n.data}),e.addUserClasses=function(n){e.classpick=!0,e.userClasses.push(n)},e.toggleEdit=function(){e.edit=!e.edit},e.removeClass=function(n){var t=e.userClasses.indexOf(n);t>-1&&e.userClasses.splice(t,1),console.log(e.userClasses)};var c=function(){$("#calendar").fullCalendar("removeEvents"),e.events=[]};e.generateSchedule=function(n){e.formatRequest=[],e.noSchedules=!1,c();for(var a=0;a<n.length;a++)e.formatRequest.push(n[a].description);if(0===e.formatRequest.length)t("error","One or more classes required");else{t("success","Your schedules are being prepared!");var l={classes:e.formatRequest,block:[]};s.postClass(l).then(function(n){r=n.data,e.viableSize=r.length,e.showCount=i+1,e.vSched=r[i],e.showBtns=!0,u()})}};var u=function(){var n=[],t=[];if("undefined"==typeof e.vSched)p();else{for(var s=0;s<e.vSched.length;s++)n.push(e.vSched[s].Times.split(" ")),t.push(e.vSched[s].Days);f(n,t)}},d=["#ff4444","#ffbb33","#00C851","#33b5e5","#2BBBAD","#4285F4","#aa66cc","#29b6f6","#f06292"],h=["#CC0000","#FF8800","#007E33","#0099CC","#00695c","#0d47a1","#9933CC","#039be5","#ec407a"],f=function(n,t){for(var s=0;s<n.length;s++){var o=l.eventObj(l.startTime(n[s]),l.endTime(n[s]),e.vSched[s].Class,l.getDow(t[s]));o.backgroundColor=d[s],o.borderColor=h[s],console.log(o),e.events.push(o)}a.reloadCal(e.events),e.showCalendar()};e.nextPage=function(){c(),i===e.viableSize-1?i=0:i++,v()},e.prevPage=function(){c(),0===i?i=e.viableSize-1:i-=1,v()};var v=function(){e.showCount=i+1,e.vSched=r[i],u()},p=function(){e.noSchedules=!0,e.showBtns=!1};e.showCalendar=function(){$(document).ready(function(){$("#calendar").fullCalendar({defaultView:"agendaWeek",defaultDate:"2017-09-25",allDaySlot:!1,weekends:!1,header:!1,minTime:"08:00:00",maxTime:"21:00:00",height:480,events:e.events,eventClick:function(e){m(e)}})})};var m=function(n){for(var t=0;t<e.vSched.length;t++)e.vSched[t].Class===n.title&&(e.classInformation=e.vSched[t],o.open({templateUrl:"../../views/classModal.html",scope:e}),$(".fancymodal-overlay fancymodal-overlay-opening").removeClass("fancymodal-overlay fancymodal-overlay-opening"),$(".fancymodal-content").removeClass("fancymodal-content").addClass("modal-content modal-dialog"))}}]),angular.module("scheduleBuilderApp").service("toastr",function(){var e=function(e,n){toastr.options={closeButton:!1,debug:!1,newestOnTop:!0,progressBar:!0,positionClass:"toast-top-right",preventDuplicates:!0,showDuration:"300",hideDuration:"1000",timeOut:"1500",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr[e](n)};return e}),angular.module("scheduleBuilderApp").service("eventService",function(){this.getDow=function(e){var n=[];return"MWF"==e?n=[1,3,5]:"TR"==e?n=[2,4]:"MW"==e?n=[1,3]:"WF"==e?n=[3,5]:"T"==e?n=[2]:"R"==e?n=[4]:"M"==e?n=[1]:"W"==e?n=[3]:"F"==e&&(n=[4]),n},this.startTime=function(e){return e.splice(0,1)},this.endTime=function(e){return e.splice(1,2)},this.eventObj=function(e,n,t,s){if("-"!==e&&"-"!==n){e=e.pop().slice(0,7),e=moment(e,["h:mmA"]).format("HH:mm"),n=n.pop().slice(0,7),n=moment(n,["h:mmA"]).format("HH:mm");var a={title:t,start:e,end:n,dow:s,backgroundColor:"",borderColor:""};return a}}}),angular.module("scheduleBuilderApp").service("calendarService",["$fancyModal",function(e){this.reloadCal=function(e){$("#calendar").fullCalendar("addEventSource",e),$("#calendar").fullCalendar("rerenderEvents")}}]);const baseUrl="https://schedule-builder-backend.herokuapp.com/api/";angular.module("scheduleBuilderApp").service("httpService",["$http",function(e){this.getClasses=function(){return e.get(baseUrl+"classes")},this.postClass=function(n){return e.post(baseUrl+"schedules",n)}}]);